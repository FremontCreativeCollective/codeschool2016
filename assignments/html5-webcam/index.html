<!DOCTYPE html>
<html lang="en">
  <head>
  	<meta charset="UTF-8">
  	<meta name="author" content="Brock Ellis">
  	<meta name="description" content="Playing with getUserMedia">
    <title>HTML5 Photo Booth</title>
  </head>
  <body>
    <h2>HTML5 Photo Booth</h2>

    <video id="live" autoplay></video>
    <canvas id="snapshot" style="display:none"></canvas>

    <p><a href="#" onclick="snap()">Take a picture!</a></p>
    <div id="filmroll"></div>

    <script>
      var video = document.getElementById("live")
      var constraints = { video: true };

	  navigator.mediaDevices.getUserMedia(constraints).then(function(stream) {
        video.srcObject = stream;
	  }).catch(function(err) {
        console.log("Unable to get video stream!", err)
	  });

      function snap() {
        live = document.getElementById("live")
        snapshot = document.getElementById("snapshot")
        filmroll = document.getElementById("filmroll")

        // Make the canvas the same size as the live video
        snapshot.width = live.clientWidth
        snapshot.height = live.clientHeight

        // Draw a frame of the live video onto the canvas
        c = snapshot.getContext("2d")
        c.drawImage(live, 0, 0, snapshot.width, snapshot.height)

        // Create an image element with the canvas image data
        img = document.createElement("img")
        img.src = snapshot.toDataURL("image/png")
        img.style.padding = 5
        img.width = snapshot.width / 2
        img.height = snapshot.height / 2

        // Add the new image to the film roll
        filmroll.appendChild(img)
      }
    </script>
  </body>
</html>